Avoiding the use of blocking operations inside a lock